---
import BaseLayout from "@components/base/BaseLayout.astro";
import ProfileCard from "@components/3dmodels/ProfileCard.tsx";
import PageHeader from "@components/common/PageHeader.astro";
import type { Models3DEntry } from "@/types";

interface Props {
  entryIndex: Models3DEntry;
  entries: Models3DEntry[];
}

const { entryIndex, entries } = Astro.props;

// Group models by new categories
const commissions = entries.filter(entry => entry.data.modelType === "commissions");
const weaponsAndToolsModels = entries.filter(entry => entry.data.modelType === "weapons-and-tools");
const itemsModels = entries.filter(entry => entry.data.modelType === "items");
const mobsModels = entries.filter(entry => entry.data.modelType === "mobs");
const blocksModels = entries.filter(entry => entry.data.modelType === "blocks");
const miscellaneousModels = entries.filter(entry => entry.data.modelType === "miscellaneous" || 
  !entry.data.modelType || 
  !["weapons-and-tools", "items", "mobs", "blocks", "commissions"].includes(entry.data.modelType));

// Create tabs data WITHOUT the about section
const tabsData = [
  {
    id: "weapons-and-tools",
    label: "Weapons & Equipment", 
    content: "weapons-and-tools",
    models: weaponsAndToolsModels
  },
  {
    id: "items",
    label: "Items",
    content: "items", 
    models: itemsModels
  },
  {
    id: "mobs",
    label: "Mobs",
    content: "mobs",
    models: mobsModels
  },
  {
    id: "blocks", 
    label: "Blocks",
    content: "blocks",
    models: blocksModels
  },
  {
    id: "commissions", 
    label: "Commissions",
    content: "commissions",
    models: commissions
  },
  {
    id: "miscellaneous",
    label: "Miscellaneous",
    content: "miscellaneous",
    models: miscellaneousModels
  }
];
---

<BaseLayout title={entryIndex.data.title} description={entryIndex.data.description}>
  <!-- Header card like Commissions page with custom text -->
  <section class="flex justify-center">
    <div class="container text-center m-2">
      <div class="rounded-lg p-0 bg-gradient-to-t gradient">
        <div class="rounded-lg glass px-8 py-6 intersect:animate-fadeDown opacity-0 intersect-no-queue">
          <h1 class="text-h1-sm md:text-h1 font-primary font-normal mb-4">3D Models</h1>
          <p class="text-2xl font-normal text-txt-s dark:text-darkmode-txt-s">My 3D Models/Project using Blockbench</p>
        </div>
      </div>
    </div>
  </section>

  <section class="section py-8 min-h-[60vh] flex items-center justify-center">
    <div class="container max-w-6xl">
      <div class="flex justify-center">
        <ProfileCard tabsData={tabsData} client:load />
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .section {
    padding-top: 1rem;
    padding-bottom: 1rem;
  }
  
  @media (max-width: 768px) {
    .section {
      padding-top: 0.5rem;
      padding-bottom: 0.5rem;
    }
  }
</style>